<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* 화면 초기화 */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { background: #fff; font-family: sans-serif; width: 100%; font-size: 16px; overflow-x: hidden; }

        /* 페이지 전환용 (ID 앵커 방식) */
        .page { display: none; width: 100%; min-height: 100vh; padding: 15px; background: #fff; }
        /* URL 뒤에 #ID가 붙으면 해당 화면을 보여줌 */
        #listPage:target, #writePage:target, #viewPage:target { display: block !important; }
        /* 아무 해시가 없을 때 기본 목록 표시 */
        .page:first-of-type { display: block; }
        #listPage:target ~ #default { display: none; }

        /* 버튼 스타일 (오른쪽 배치) */
        .btn-box { width: 100%; height: 45px; margin-bottom: 10px; position: relative; }
        .btn {
            display: block; width: 100px; height: 38px; line-height: 38px;
            background: #3b4890; color: #fff; text-align: center;
            text-decoration: none; font-size: 14px; font-weight: bold;
            border-radius: 4px; position: absolute; right: 0; top: 0;
        }
        .btn-gray { background: #666; right: 80px; width: 70px; }
        .btn-red { background: #c00; right: 0; width: 70px; }
        .btn-list { background: #777; right: 155px; width: 70px; }

        /* 목록 아이템 */
        .list-item {
            display: block; width: 100%; padding: 18px 5px;
            border-bottom: 1px solid #eee; text-decoration: none; color: #000;
            font-size: 18px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }

        /* 입력창 */
        .input-box { width: 100%; padding: 12px; font-size: 16px; border: 1px solid #ccc; margin-bottom: 10px; display: block; }
        textarea.input-box { height: 160px; }

        /* 본문 내용 */
        .v-title { font-size: 20px; font-weight: bold; border-bottom: 2px solid #3b4890; padding-bottom: 10px; margin-bottom: 10px; }
        .v-content { font-size: 17px; line-height: 1.6; white-space: pre-wrap; padding-bottom: 80px; }
        
        /* 하단 고정 버튼 바 */
        .bottom-bar { position: fixed; bottom: 15px; right: 15px; display: flex; gap: 5px; }
    </style>
</head>
<body>

<div id="listPage" class="page">
    <div class="btn-box">
        <a href="#writePage" class="btn">새 글 쓰 기</a>
    </div>
    <div id="listContent"></div>
</div>

<div id="writePage" class="page">
    <input type="text" id="inpTitle" class="input-box" placeholder="제목">
    <textarea id="inpContent" class="input-box" placeholder="내용"></textarea>
    <div class="btn-box">
        <a href="#listPage" class="btn" onclick="saveData()">저장 완료</a>
        <a href="#listPage" class="btn btn-gray">취소</a>
    </div>
</div>

<div id="viewPage" class="page">
    <div id="viewContent"></div>
    <div class="bottom-bar">
        <a href="#listPage" class="btn btn-list">목록</a>
        <a href="#listPage" id="delBtn" class="btn btn-red">삭제</a>
    </div>
</div>

<script>
    var KEY = "folder_board_permanent";

    function getPosts() {
        try {
            var d = localStorage.getItem(KEY);
            return d ? JSON.parse(d) : [];
        } catch(e) { return []; }
    }

    function renderList() {
        var posts = getPosts();
        var container = document.getElementById('listContent');
        if(!container) return;
        container.innerHTML = "";

        if(posts.length === 0) {
            container.innerHTML = "<div style='padding:40px; text-align:center; color:#999;'>글이 없습니다.</div>";
            return;
        }

        posts.sort(function(a, b) { return b.id - a.id; });

        for(var i=0; i<posts.length; i++) {
            (function(p) {
                var a = document.createElement('a');
                a.className = 'list-item';
                a.href = "#viewPage"; // 앵커 이동 우선
                a.onclick = function() { loadView(p.id); };
                a.innerText = p.title;
                container.appendChild(a);
            })(posts[i]);
        }
    }

    function saveData() {
        var t = document.getElementById('inpTitle').value;
        var c = document.getElementById('inpContent').value;
        if(!t.trim()) return;

        var posts = getPosts();
        posts.push({ id: Date.now(), title: t, content: c });
        localStorage.setItem(KEY, JSON.stringify(posts));
        
        document.getElementById('inpTitle').value = "";
        document.getElementById('inpContent').value = "";
        renderList();
    }

    function loadView(id) {
        var posts = getPosts();
        var p = posts.filter(function(x) { return x.id === id; })[0];
        if(!p) return;

        document.getElementById('viewContent').innerHTML = 
            "<div class='v-title'>" + p.title + "</div>" +
            "<div class='v-content'>" + p.content + "</div>";
        
        document.getElementById('delBtn').onclick = function() {
            if(confirm("삭제하시겠습니까?")) {
                var newPosts = posts.filter(function(x) { return x.id !== id; });
                localStorage.setItem(KEY, JSON.stringify(newPosts));
                renderList();
            }
        };
    }

    // 주소창의 #ID가 바뀔 때마다 리스트를 새로 그림
    window.onhashchange = renderList;

    window.onload = function() {
        renderList();
        // 초기 접속 시 아무것도 없으면 목록으로 강제 이동
        if(!location.hash) location.hash = "#listPage";
    };
</script>

</body>
</html>
